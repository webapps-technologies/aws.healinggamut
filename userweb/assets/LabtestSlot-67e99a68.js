import{u as X,q as Z,m as ee,c,z as I,r as te,y as k,D as se,n as oe,a as v,o as n,b as r,d as e,e as h,t as i,j as Y,h as p,v as b,i as m,F as ae,k as le,g as y,w as U,B as ie}from"./index-477b0694.js";import{_ as ne}from"./calender-9d47370a.js";const re={class:"apt-slot-card"},de={class:"card-header"},ce={class:"left-card-header"},ue={class:"icon"},me=e("h3",null,"Labtest Booking",-1),_e={class:"card-body labtest-booking"},ve={class:"clinic-info"},he={class:"about"},pe={class:"rate-row"},be={class:"name"},fe={class:"rating"},ge={class:"text"},ke={class:"date-input w-10-r"},ye=["min"],Pe=e("div",{class:"icon"},[e("img",{src:ne,alt:""})],-1),Ne={key:0,class:"mb-10"},De={class:"card total-card"},Te=e("div",{class:"card-header"},"Price Details",-1),Se={class:"card-body"},Le={class:"price"},xe={class:"title"},Ve={class:"val"},Me={class:"price"},we=e("div",{class:"title"},"Platform Fee",-1),Ee={class:"val text-green"},Ae={class:"price"},Ce=e("div",{class:"title"},"Discount",-1),Fe={class:"val text-green"},Ie=e("div",{class:"price"},[e("div",{class:"title"},"Payment Gateway Charge"),e("div",{class:"val text-green"},"₹"+i(15))],-1),Ye={class:"price total f-w-bold"},Ue=e("div",{class:"title"},"Total Amount",-1),Oe={class:"val"},Be={class:"save text-green f-w-bold"},Ge={class:"slot-section"},Re={class:"slot-header"},ze=e("h4",null,"Slots :",-1),He={class:"card-container"},$e=["onClick"],qe={class:"day"},je={class:"date"},Ke={class:"slot-status"},We={key:0,class:"text text-green f-w-bold"},Je={key:1,class:"text text-red f-w-bold"},Qe={key:0},Xe={class:"book-btn"},Ze=e("div",{class:"title",showHeader:"true"},"Patient Detail",-1),et={action:"",class:"form"},tt={class:"form-Container"},st={class:"tow-row"},ot={class:"form-item mb-16"},at=e("div",{class:"title"},"First Name",-1),lt={key:0,class:"err-msg"},it={class:"form-item mb-16"},nt=e("div",{class:"title"},"Last Name",-1),rt={key:0,class:"err-msg"},dt={class:"tow-row"},ct={class:"form-item mb-16"},ut=e("div",{class:"title"},"Phone",-1),mt={key:0,class:"err-msg"},_t={class:"form-item mb-16"},vt=e("div",{class:"title"},"Email",-1),ht={key:0,class:"err-msg"},pt={class:"tow-row"},bt={class:"form-item mb-16"},ft=e("div",{class:"title"},"Gender",-1),gt={key:0,class:"err-msg"},kt={class:"form-item mb-16"},yt=e("div",{class:"title"},"Dob",-1),Pt=["max"],Nt={key:0,class:"err-msg"},Dt={class:"save-btn"},Vt={__name:"LabtestSlot",setup(Tt){const u=X(),w=Z(),O=ee(),a=c(()=>u.state.LabTest),E=I([]),f=I(null),P=[{id:"MALE",name:"MALE"},{id:"FEMALE",name:"FEMALE"},{id:"OTHER",name:"OTHER"}],t=te({limit:10,offset:0,search:"",status:"ACTIVE",submit:!1,id:null,calendarDate:k().format("YYYY-MM-DD"),lockerStatus:null,doctorId:null,firstName:null,lastName:null,patientGender:P[0].id,contactNumber:null,email:null,dob:null,timePicker:"00:00",timePickerStatus:!1,scheduleOn:k().format("YYYY-MM-DD"),patientModal:!1});se(()=>{t.firstName=null,t.lastName=null,t.patientGender=P[0].id,t.contactNumber=null,t.email=null,t.dob=null,t.timePicker="00:00",t.patientModal=!1}),oe(()=>{w.query.id&&(t.laboratoryId=w.query.id,a.value.submitLabTest=[],B())});function B(){u.dispatch("LabTest/getOnelaboratory",{laboratoryId:t.laboratoryId})}function G(){var l;if(!localStorage.getItem("userId"))return O.push({path:"/login"});if(f.value<0||f.value===null)return u.dispatch("Alert/error",{msg:"Please Select Slot!"});if(!t.timePickerStatus)return u.dispatch("Alert/error",{msg:"Selected Slot is Not Available"});if(t.timePicker=="00:00")return u.dispatch("Alert/error",{msg:"Please Select Time!"});if(((l=a.value.submitLabTest)==null?void 0:l.length)<=0)return u.dispatch("Alert/error",{msg:"Please Select Test"}),null;t.patientModal=!0}async function R(){if(t.timePicker=="00:00")return u.dispatch("Alert/error",{msg:"Please Select Time!"});if(D.value||T.value||S.value||x.value||L.value||V.value)return t.submit=!0,null;t.submit=!1;const s={scheduleOn:t.scheduleOn+"T"+t.timePicker,scheduleFor:null,type:"OFFLINE",appointmentFor:"Lab Appointment",mode:"NEW",scheduleType:"REGULAR",note:null,doctorReference:null,collectionAt:null,collectionCenter:null,collectionBy:null,patientDetailId:null,franchiseId:null,pid:null,doctorDetailId:null,patientDetail:{firstName:t.firstName,lastName:t.lastName,dob:t.dob,gender:t.patientGender,mobile:t.contactNumber,email:t.email},labtest:a.value.submitLabTest,doctorFees:g.value.toFixed(2),hospitalFees:0,commission:C(g.value,a.value.commission),gst:0,discount:N.value,lockerStatus:"NO",slotId:null,laboratoryId:a.value.id,organizationId:null};console.log(s),await u.dispatch("Appointments/bookAppointments",s)}const z=(l,s,d,_)=>{t.scheduleOn=_,t.timePickerStatus=s,s&&(f.value=l,E.value=d)};function H(l){if(l){var s=k(l).format("MMM Do YYYY");return s}}function $(){return E.value=[],f.value=null,a.value.slotTimeData=[],u.commit("LabTest/SET_LABTEST_SCHEDULE",t.calendarDate)}function A(){return k().format("YYYY-MM-DD")}const q=c(()=>a.value.submitLabTest.length>0?a.value.submitLabTest.reduce((s,d)=>s+d.price,0):0),N=c(()=>{if(a.value.submitLabTest.length>0){const l=a.value.submitLabTest.reduce((d,_)=>d+_.discountPrice,0);return a.value.submitLabTest.reduce((d,_)=>d+_.price,0)-l}else return 0}),g=c(()=>a.value.submitLabTest.length>0?a.value.submitLabTest.reduce((s,d)=>s+d.discountPrice,0):0),C=(l,s)=>l*s/100,D=c(()=>{if(!t.firstName)return"Please enter first name!"}),T=c(()=>{if(!t.lastName)return"Please enter last name!"}),S=c(()=>{if(!t.dob)return"Please enter date of birth!"}),L=c(()=>{if(!t.patientGender)return"Please select gender!"}),x=c(()=>{if(!t.contactNumber)return"Please enter phone no!"}),V=c(()=>{let l=/^([a-z0-9.-]+)@([a-z]{4,12}).([a-z.]{2,20})$/;if(t.email){if(!l.test(t.email))return"Please enter valid email!"}else return"Please enter email!"});function j(l){let s=String.fromCharCode(l.keyCode);if(/^[0-9]+$/.test(s))return!0;l.preventDefault()}return(l,s)=>{var F;const d=v("icon-lab"),_=v("icon-star"),K=v("time-picker"),W=v("icon-cross"),J=v("Select"),Q=v("Modal");return n(),r("section",re,[e("div",de,[e("div",ce,[e("div",ue,[h(d)]),me])]),e("div",_e,[e("div",ve,[e("div",he,[e("div",pe,[e("h3",be,i(a.value.name),1),e("div",fe,[h(_),Y(" "+i(a.value.rating),1)])]),e("div",ge,i(a.value.address),1)]),e("div",ke,[p(e("input",{type:"date","onUpdate:modelValue":s[0]||(s[0]=o=>t.calendarDate=o),min:A(),onChange:$},null,40,ye),[[b,t.calendarDate]]),Pe])]),a.value.selectDR?m("",!0):(n(),r("div",Ne,[Y(" Appointment on "),e("strong",null,i(H(t.scheduleOn)),1)])),e("div",De,[Te,e("div",Se,[e("div",Le,[e("div",xe," Price ("+i((F=a.value.submitLabTest)==null?void 0:F.length)+" Item) ",1),e("div",Ve,"₹"+i(q.value.toFixed(2)),1)]),e("div",Me,[we,e("div",Ee," ₹"+i(C(g.value,a.value.commission).toFixed(2)),1)]),e("div",Ae,[Ce,e("div",Fe,"₹"+i(N.value.toFixed(2)),1)]),Ie,e("div",Ye,[Ue,e("div",Oe,"₹"+i((g.value+15).toFixed(2)),1)]),e("div",Be," You will save ₹"+i(N.value.toFixed(2))+" on this order ",1)])]),e("div",Ge,[e("div",Re,[ze,e("div",He,[(n(!0),r(ae,null,le(a.value.schedule,(o,M)=>(n(),r("div",{class:ie(["slot-card",{active:f.value==M}]),key:M,onClick:y(St=>z(M,o.status,[],o.date),["prevent"])},[e("div",qe,i(o.name),1),e("div",je,i(o.date),1),e("div",Ke,[o.status?(n(),r("span",We,"Slots Available")):(n(),r("span",Je,"Slot Not Available"))])],10,$e))),128))])]),t.timePickerStatus?(n(),r("div",Qe,[h(K,{class:"mb-16",modelValue:t.timePicker,"onUpdate:modelValue":s[1]||(s[1]=o=>t.timePicker=o)},null,8,["modelValue"])])):m("",!0),e("div",Xe,[e("button",{type:"button",class:"btn primary-btn w-10-r",onClick:y(G,["prevent"])}," Book ")])])]),h(Q,{show:t.patientModal,"onUpdate:show":s[10]||(s[10]=o=>t.patientModal=o),class:"details-modal",headerClasses:"header-bg"},{header:U(()=>[Ze,e("div",{class:"close-btn",onClick:s[2]||(s[2]=y(o=>t.patientModal=!1,["prevent"]))},[h(W)])]),default:U(()=>[e("form",et,[e("div",tt,[e("div",st,[e("div",ot,[at,p(e("input",{type:"text","onUpdate:modelValue":s[3]||(s[3]=o=>t.firstName=o),placeholder:"Enter First Name",maxlength:"20"},null,512),[[b,t.firstName]]),t.submit&&D.value?(n(),r("div",lt,i(D.value),1)):m("",!0)]),e("div",it,[nt,p(e("input",{type:"text","onUpdate:modelValue":s[4]||(s[4]=o=>t.lastName=o),placeholder:"Enter Last Name",maxlength:"20"},null,512),[[b,t.lastName]]),t.submit&&T.value?(n(),r("div",rt,i(T.value),1)):m("",!0)])]),e("div",dt,[e("div",ct,[ut,p(e("input",{type:"text","onUpdate:modelValue":s[5]||(s[5]=o=>t.contactNumber=o),placeholder:"Enter Phone",onKeypress:s[6]||(s[6]=o=>j(o)),maxlength:"10"},null,544),[[b,t.contactNumber]]),t.submit&&x.value?(n(),r("div",mt,i(x.value),1)):m("",!0)]),e("div",_t,[vt,p(e("input",{type:"text","onUpdate:modelValue":s[7]||(s[7]=o=>t.email=o),placeholder:"Enter Email"},null,512),[[b,t.email]]),t.submit&&V.value?(n(),r("div",ht,i(V.value),1)):m("",!0)])]),e("div",pt,[e("div",bt,[ft,h(J,{modelValue:t.patientGender,"onUpdate:modelValue":s[8]||(s[8]=o=>t.patientGender=o),options:P,placeholder:"Select Gender"},null,8,["modelValue"]),t.submit&&L.value?(n(),r("div",gt,i(L.value),1)):m("",!0)]),e("div",kt,[yt,p(e("input",{type:"date","onUpdate:modelValue":s[9]||(s[9]=o=>t.dob=o),placeholder:"Select Date",max:A()},null,8,Pt),[[b,t.dob]]),t.submit&&S.value?(n(),r("div",Nt,i(S.value),1)):m("",!0)])])]),e("div",Dt,[e("button",{type:"button",class:"btn primary-btn",onClick:y(R,["prevent"])}," Submit ")])])]),_:1},8,["show"])])}}};export{Vt as default};

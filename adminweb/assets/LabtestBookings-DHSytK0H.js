import{e as _,c as ve,z as Ve,j as g,k as s,l as u,y as n,m as o,A as i,F as D,B as ke,H as y,u as L,I as C,E as m,x as h,t as N}from"./@vue-bQO0P59g.js";import{C as ee,M as De,I as xe,W as Le}from"./@mdi-CZk6uuAL.js";import{h as x}from"./moment-Cl4UOzQZ.js";import{u as Ce}from"./vue-router-D5J0r3Gc.js";import{u as Me}from"./vuex-DHdsu8jA.js";import{e as te}from"./export-from-json-BvevaQwb.js";const Ae={class:"grid grid-cols-2 lg:grid-cols-6 gap-4"},Ee={class:"grid grid-cols-1 lg:grid-cols-1 gap-6 new-table"},Ne={class:"mt-3 px-6 table-sec"},Se={key:0},Te=n("caption",null,null,-1),Oe=n("thead",null,[n("tr",null,[n("th",null,"Sl.No."),n("th",null,"Test Name"),n("th",null,"Patient"),n("th",null,"Number"),n("th",null,"Total Amount"),n("th",null,"Booking Date"),n("th",null,"Time"),n("th",null,"Status"),n("th",null,"Created At"),n("th",{class:"text-center"},"Actions")])],-1),Be={"data-label":"Sr.No"},Ie={key:0,"data-label":"Test Name"},Ue={key:1,"data-label":"Test Name"},we={"data-label":"Patient"},Pe={"data-label":"Number"},Ye={"data-label":"Amount"},Fe={"data-label":"Booking Date"},je={"data-label":"Time"},Re={key:2,"data-label":"Status",class:"text-blue-500 font-bold"},$e={key:3,"data-label":"Status",class:"text-green-500 font-bold"},qe={key:4,"data-label":"Status",class:"text-yellow-500 font-bold"},We={key:5,"data-label":"Status",class:"text-lime-500 font-bold"},Ge={key:6,"data-label":"Status",class:"text-pink-500 font-bold"},He={key:7,"data-label":"Status",class:"text-rose-500 font-bold"},Ke={key:8,"data-label":"Status",class:"text-fuchsia-500 font-bold"},Je={key:9,"data-label":"Status",class:"text-cyan-500 font-bold"},ze={key:10,"data-label":"Status",class:"text-sky-500 font-bold"},Ze={"data-label":"CreatedAt"},Qe={class:"actions-cell"},Xe={key:0,class:"flex justify-center items-center"},et=n("div",{class:"spinner-dual-ring"},[n("div",{class:"ldio"},[n("div"),n("div",null,[n("div")])])],-1),tt=[et],lt={class:"grid grid-cols-1 lg:grid-cols-4 gap-6"},ot={class:"h-10 mt-9"},at={key:0,class:"flex lg:justify-end sm:justify-center sm:mt-2 sm:pl-20 pr-24 -mt-2"},nt=n("span",{class:"text-xs text-red-500"},"Required",-1),st=[nt],dt={key:0,class:"grid grid-cols-1 lg:grid-cols-1 gap-6 mb-6 px-8 mt-4"},it={class:"text-left flex justify-between items-center my-1.5 px-1 py-1.5 rounded shadow-md shadow-blue-100"},rt={class:"text-slate-500"},ut={class:"grid grid-cols-1 lg:grid-cols-3 gap-6"},mt={class:"grid grid-cols-1 lg:grid-cols-2 gap-6"},pt={class:"grid grid-cols-1 lg:grid-cols-1 gap-6"},ct={class:"p-2 mt-3 flex w-50 overflow-x-auto"},bt={class:"w-60"},ft=n("br",null,null,-1),_t={class:"flex justify-between items-center border-solid border-2 border-neutral-200 rounded-md p-1.5"},gt={class:"font-medium text-slate-500"},yt=n("br",null,null,-1),Ct={__name:"LabtestBookings",setup(ht){const M=Me(),le=Ce(),f=_(()=>M.state.Appointment),O=[{id:"Mr.",label:"Mr."},{id:"Mrs.",label:"Mrs."},{id:"Miss.",label:"Miss."},{id:"Dr.",label:"Dr."},{id:"Master.",label:"Master."}],B=[{id:!0,label:"Yes"},{id:!1,label:"No"}],I=[{id:"Male",label:"Male"},{id:"Female",label:"Female"},{id:"Other",label:"Other"}],U=[{id:"A+",label:"A+"},{id:"A-",label:"A-"},{id:"B+",label:"B+"},{id:"B-",label:"B-"},{id:"O+",label:"O+"},{id:"O-",label:"O-"},{id:"AB+",label:"AB+"},{id:"AB-",label:"AB-"}],w=[{id:"Father",label:"Father"},{id:"Mother",label:"Mother"},{id:"Brother",label:"Brother"},{id:"Sister",label:"Sister"},{id:"Son",label:"Son"},{id:"Daughter",label:"Daughter"},{id:"Husband",label:"Husband"},{id:"Wife",label:"Wife"},{id:"Myself",label:"Myself"},{id:"Other",label:"Other"}],oe=[{id:"ONLINE",label:"ONLINE"},{id:"OFFLINE",label:"OFFLINE"},{id:"STUDIO CLINIC",label:"STUDIO CLINIC"},{id:"LAB TEST",label:"LAB TEST"}],P=[{id:"PENDING",label:"PENDING"},{id:"COMPLETED",label:"COMPLETED"},{id:"REJECTED",label:"REJECTED"},{id:"ALL",label:"ALL"}],ae=[{id:"ALL",label:"ALL"},{id:"NEW",label:"NEW"},{id:"FOLLOW UP",label:"FOLLOW UP"}],ne=[{id:"ALL",label:"ALL"},{id:"REGULAR",label:"REGULAR"},{id:"RESCHEDULE",label:"RESCHEDULE"}],se=[{id:"Lab Appointment",label:"Lab Appointment"},{id:"Doctor Appointment",label:"Doctor Appointment"}],de=/^([\w\.\+]{1,})([^\W])(@)([\w]{1,})(\.[\w]{1,})+$/,ie=/^\d{15}$/,e=ve({limit:10,offset:0,keyword:"",status:P[0],type:oe[0],mode:ae[0],fromDate:x().subtract(2,"days").format("YYYY-MM-DD"),toDate:x().add(30,"days").format("YYYY-MM-DD"),scheduleType:ne[0],appointmentFor:se[0],investigationModal:!1,labselect:null,cModal:!1,title:O[0],name:null,email:null,gender:I[0],dob:x().format("YYYY-MM-DD"),blood_group:U[0],relationship:w[0],city:null,total_booking_amount:0,pincode:null,address_1:null,address_2:null,alternative_number:null,is_cod:B[0],collection_charges:null,bookingDate:x().format("YYYY-MM-DD"),labtestScheduleId:"",history:[],labtest:[]});Ve(()=>{A()});function A(){var d,t,b,r,c;M.dispatch("Appointment/getAppointment",{limit:e.limit,offset:e.offset,keyword:e.keyword,status:(d=e.status)==null?void 0:d.id,type:(t=e.type)==null?void 0:t.id,fromDate:e.fromDate,toDate:e.toDate,mode:(b=e.mode)==null?void 0:b.id,scheduleType:(r=e.scheduleType)==null?void 0:r.id,appointmentFor:(c=e.appointmentFor)==null?void 0:c.id})}function re(){e.offset=e.offset+e.limit,A()}function Y(d){e.offset=0,A()}function ue(d){const t="Labtest bookings",b=te.types.xls;d&&te({data:d,fileName:t,exportType:b})}function me(d){le.push({path:"/labtest/booking/info",query:{id:d}})}function F(d){return d?x(d).format("DD MMM YYYY"):"-"}function pe(d){return d?x(d).format("LT"):"-"}function ce(){e.investigationModal=!0}function be(d,t,b,r,c){const E={title:t,price:b,discount:r,net_amount:c,labtestId:d};e.labtest.findIndex(k=>k===t)<0?(e.labtest.push(t),e.history.push(E)):M.dispatch("Alert/error",{msg:"Already Selected"}),e.total_booking_amount=e.history.reduce((k,p)=>k+parseInt(p.net_amount),0)}function j(d){e.labtest.splice(d,1),e.history.splice(d,1),e.total_booking_amount=e.history.reduce((t,b)=>t+parseInt(b.net_amount),0)}function fe(d){if(d.length>0)return d.reduce((b,r)=>{var c;return b+((c=r.labTest)==null?void 0:c.discountPrice)},0)}function _e(){e.cModal=!0,e.total_booking_amount=null,e.name=null,e.email=null,e.city=null,e.pincode=null,e.address_1=null,e.address_2=null,e.alternative_number=null,e.collection_charges=null}async function ge(){if(R.value||$.value||q.value||W.value||G.value||H.value||K.value||J.value||e.labtest.length<=0)return null;await M.dispatch("LabtestBooking/savenew",{title:e.title.id,name:e.name,email:e.email,gender:e.gender.id,dob:e.dob,blood_group:e.blood_group.id,relationship:e.relationship.id,city:e.city,total_booking_amount:e.total_booking_amount,pincode:e.pincode,address_1:e.address_1,address_2:e.address_2,alternative_number:e.alternative_number,is_cod:e.is_cod.id,collection_charges:e.collection_charges,bookingDate:e.bookingDate,labtestScheduleId:e.labtestScheduleId,history:e.history}),e.cModal=!1}const R=_(()=>{if(!e.name)return"Name required!"}),$=_(()=>{if(!e.email)return"Email required!";if(!de.test(e.email))return"Invalid email!"}),q=_(()=>{if(!e.alternative_number)return"Mobile no required!";if(!ie.test(e.alternative_number))return"Invalid Mobile no!"}),W=_(()=>{if(e.city){if(e.city.length<3)return"Enter Valid Location!"}else return"Location required!"}),G=_(()=>{if(e.pincode){if(e.pincode.length<6||e.pincode.length>6)return"Enter Valid Pincode !"}else return"Pincode required!"}),H=_(()=>{if(!e.address_1)return"Address required!"}),K=_(()=>{if(!e.total_booking_amount)return"Total booking amount required!"}),J=_(()=>{if(!e.collection_charges)return"Collection charges required!"});function ye(d){let t=String.fromCharCode(d.keyCode);if(/^[a-zA-Z ]+$/.test(t))return!0;d.preventDefault()}function S(d){let t=String.fromCharCode(d.keyCode);if(/^[0-9]+$/.test(t))return!0;d.preventDefault()}return(d,t)=>{const b=g("hero-bar"),r=g("control"),c=g("base-button"),E=g("main-section"),V=g("base-buttons"),k=g("card-component"),p=g("field"),z=g("modal-box");return s(),u(D,null,[n("section",null,[o(b,null,{default:i(()=>[ke("Labtest Bookings")]),_:1}),o(E,null,{default:i(()=>[n("div",Ae,[o(r,{modelValue:e.search,"onUpdate:modelValue":t[0]||(t[0]=l=>e.search=l),onKeyup:t[1]||(t[1]=l=>Y(l.target.value)),type:"text",placeholder:"Search by : Patient, Number"},null,8,["modelValue"]),o(r,{modelValue:e.fromDate,"onUpdate:modelValue":t[2]||(t[2]=l=>e.fromDate=l),type:"date"},null,8,["modelValue"]),o(r,{modelValue:e.toDate,"onUpdate:modelValue":t[3]||(t[3]=l=>e.toDate=l),type:"date"},null,8,["modelValue"]),o(r,{modelValue:e.status,"onUpdate:modelValue":t[4]||(t[4]=l=>e.status=l),options:P},null,8,["modelValue"]),o(c,{type:"button",color:"themeColor",label:"SUBMIT",onClick:t[5]||(t[5]=y(l=>A(),["prevent"])),effect:""}),o(c,{type:"button",color:"themeColor",small:"",label:"Export to excel",onClick:t[6]||(t[6]=y(l=>ue(f.value.excelData),["prevent"])),effect:""})])]),_:1}),o(E,null,{default:i(()=>[n("div",Ee,[o(k,{class:"mb-6",title:"List (Total: "+f.value.total+")",onHeaderIconClicked:t[7]||(t[7]=l=>_e()),headerIcon:L(ee),iconText:"Add New Booking","has-table":""},{default:i(()=>[n("div",Ne,[f.value.data.length>0?(s(),u("table",Se,[Te,Oe,n("tbody",null,[(s(!0),u(D,null,C(f.value.data,(l,a)=>{var v,T,Z;return s(),u("tr",{key:a},[n("td",Be,m(a+1),1),l.appointmentLabtest.length>0?(s(),u("td",Ie,[(s(!0),u(D,null,C(l.appointmentLabtest,(Q,he)=>{var X;return s(),u("span",{key:he},m((X=Q.labTest)==null?void 0:X.title)+" / ",1)}),128))])):(s(),u("td",Ue,"None")),n("td",we,m((v=l.patientDetail)==null?void 0:v.firstName)+" "+m((T=l.patientDetail)==null?void 0:T.lastName),1),n("td",Pe,m((Z=l.patientDetail)==null?void 0:Z.mobile),1),n("td",Ye,"â‚¹"+m(fe(l.appointmentLabtest)),1),n("td",Fe,m(F(l.scheduleOn)),1),n("td",je,m(pe(l.scheduleOn)),1),l.status=="Publish"?(s(),u("td",Re,m(l.status),1)):l.status=="Paid"?(s(),u("td",$e,m(l.status),1)):l.status=="Pending"?(s(),u("td",qe,m(l.status),1)):l.status=="Done"?(s(),u("td",We,m(l.status),1)):l.status=="Failed"?(s(),u("td",Ge,m(l.status),1)):l.status=="Cancelled"?(s(),u("td",He,m(l.status),1)):l.status=="Refund"?(s(),u("td",Ke,m(l.status),1)):l.status=="Subscription"?(s(),u("td",Je,m(l.status),1)):(s(),u("td",ze,m(l.status),1)),n("td",Ze,m(F(l.createdAt)),1),n("td",Qe,[o(V,{type:"justify-center lg:justify-center"},{default:i(()=>[o(c,{type:"button",title:"View",color:"info",icon:L(De),small:"",rounded:"",onClick:y(Q=>me(l.id),["prevent"])},null,8,["icon","onClick"])]),_:2},1024)])])}),128))])])):h("",!0)]),f.value.data.length<=0?(s(),N(k,{key:0,empty:""})):h("",!0)]),_:1},8,["title","headerIcon"])]),f.value.dataLoader?(s(),u("div",Xe,tt)):h("",!0),f.value.loadMore&&!f.value.dataLoader?(s(),N(V,{key:1,type:"justify-center lg:justify-center"},{default:i(()=>[o(c,{type:"button",color:"themeColor",label:"Load More",onClick:t[8]||(t[8]=y(l=>re(),["prevent"]))})]),_:1})):h("",!0)]),_:1})]),o(z,{modelValue:e.cModal,"onUpdate:modelValue":t[30]||(t[30]=l=>e.cModal=l),title:"New Labtest Booking",width:"w-3/5"},{default:i(()=>{var l;return[n("section",null,[n("div",lt,[o(p,{label:"Title *"},{default:i(()=>[o(r,{modelValue:e.title,"onUpdate:modelValue":t[9]||(t[9]=a=>e.title=a),options:O},null,8,["modelValue"])]),_:1}),o(p,{label:"Name *",help:R.value},{default:i(()=>[o(r,{modelValue:e.name,"onUpdate:modelValue":t[10]||(t[10]=a=>e.name=a),type:"text",name:"name",autocomplete:"name",placeholder:"Enter Name",onKeypress:t[11]||(t[11]=a=>ye(a))},null,8,["modelValue"])]),_:1},8,["help"]),o(p,{label:"Email *",help:$.value},{default:i(()=>[o(r,{modelValue:e.email,"onUpdate:modelValue":t[12]||(t[12]=a=>e.email=a),type:"text",name:"email",autocomplete:"email",placeholder:"Enter Email"},null,8,["modelValue"])]),_:1},8,["help"]),o(p,{label:"Number *",help:q.value},{default:i(()=>[o(r,{modelValue:e.alternative_number,"onUpdate:modelValue":t[13]||(t[13]=a=>e.alternative_number=a),type:"text",name:"alternative_number",autocomplete:"alternative_number",onKeypress:t[14]||(t[14]=a=>S(a)),placeholder:"Enter Phone Number"},null,8,["modelValue"])]),_:1},8,["help"]),o(p,{label:"Gender *"},{default:i(()=>[o(r,{modelValue:e.gender,"onUpdate:modelValue":t[15]||(t[15]=a=>e.gender=a),options:I},null,8,["modelValue"])]),_:1}),o(p,{label:"Date of Birth *"},{default:i(()=>[o(r,{modelValue:e.dob,"onUpdate:modelValue":t[16]||(t[16]=a=>e.dob=a),type:"date",name:"dob"},null,8,["modelValue"])]),_:1}),o(p,{label:"Blood Group"},{default:i(()=>[o(r,{modelValue:e.blood_group,"onUpdate:modelValue":t[17]||(t[17]=a=>e.blood_group=a),options:U},null,8,["modelValue"])]),_:1}),o(p,{label:"Relationship"},{default:i(()=>[o(r,{modelValue:e.relationship,"onUpdate:modelValue":t[18]||(t[18]=a=>e.relationship=a),options:w},null,8,["modelValue"])]),_:1}),o(p,{label:"Location *",help:W.value},{default:i(()=>[o(r,{modelValue:e.city,"onUpdate:modelValue":t[19]||(t[19]=a=>e.city=a),type:"text",name:"location",autocomplete:"location",placeholder:"Enter Location"},null,8,["modelValue"])]),_:1},8,["help"]),o(p,{label:"Pincode *",help:G.value},{default:i(()=>[o(r,{modelValue:e.pincode,"onUpdate:modelValue":t[20]||(t[20]=a=>e.pincode=a),type:"text",name:"pincode",autocomplete:"pincode",placeholder:"Enter Pincode",onKeypress:t[21]||(t[21]=a=>S(a))},null,8,["modelValue"])]),_:1},8,["help"]),o(p,{label:"Booking Date"},{default:i(()=>[o(r,{modelValue:e.bookingDate,"onUpdate:modelValue":t[22]||(t[22]=a=>e.bookingDate=a),type:"date",name:"bookingDate"},null,8,["modelValue"])]),_:1}),n("div",ot,[o(V,{type:"justify-center lg:justify-center"},{default:i(()=>[o(c,{type:"button",color:"info",label:"Add Test",small:"",onClick:t[23]||(t[23]=y(a=>ce(),["prevent"]))})]),_:1}),e.labtest.length<=0?(s(),u("div",at,st)):h("",!0)])]),((l=e.labtest)==null?void 0:l.length)>0?(s(),u("div",dt,[o(p,{class:"text-center"},{default:i(()=>[(s(!0),u(D,null,C(e.labtest,(a,v)=>(s(),u("label",{for:"Investigation",key:v},[n("div",it,[n("span",rt,m(a),1),n("span",null,[o(c,{class:"mx-1",color:"danger",icon:L(xe),title:"Delete",small:"",onClick:T=>j(v)},null,8,["icon","onClick"])])])]))),128))]),_:1})])):h("",!0),n("div",ut,[o(p,{label:"Total Booking Amount *",help:K.value},{default:i(()=>[o(r,{modelValue:e.total_booking_amount,"onUpdate:modelValue":t[24]||(t[24]=a=>e.total_booking_amount=a),type:"text",name:"total_booking_amount",autocomplete:"Total Booking Amount",disabled:!0},null,8,["modelValue"])]),_:1},8,["help"]),o(p,{label:"Collection Charges *",help:J.value},{default:i(()=>[o(r,{modelValue:e.collection_charges,"onUpdate:modelValue":t[25]||(t[25]=a=>e.collection_charges=a),type:"text",name:"collection_charges",placeholder:"Enter Collection Charges",autocomplete:"collection_charges",onKeypress:t[26]||(t[26]=a=>S(a))},null,8,["modelValue"])]),_:1},8,["help"]),o(p,{label:"COD *"},{default:i(()=>[o(r,{modelValue:e.is_cod,"onUpdate:modelValue":t[27]||(t[27]=a=>e.is_cod=a),options:B},null,8,["modelValue"])]),_:1})]),n("div",mt,[o(p,{label:"Address 1 *",help:H.value},{default:i(()=>[o(r,{modelValue:e.address_1,"onUpdate:modelValue":t[28]||(t[28]=a=>e.address_1=a),type:"textarea",name:"address_1",autocomplete:"address_1",placeholder:"Enter Address"},null,8,["modelValue"])]),_:1},8,["help"]),o(p,{label:"Address 2 *"},{default:i(()=>[o(r,{modelValue:e.address_2,"onUpdate:modelValue":t[29]||(t[29]=a=>e.address_2=a),type:"textarea",name:"address_2",autocomplete:"Address_2",placeholder:"Enter Address"},null,8,["modelValue"])]),_:1})]),o(V,{type:"justify-center lg:justify-center pt-5"},{default:i(()=>[f.value.loaderNew?h("",!0):(s(),N(c,{key:0,type:"button",color:"themeColor",small:"",label:"Submit",onClick:y(ge,["prevent"])}))]),_:1})])]}),_:1},8,["modelValue"]),o(z,{modelValue:e.investigationModal,"onUpdate:modelValue":t[34]||(t[34]=l=>e.investigationModal=l),title:"Add Test"},{default:i(()=>[n("section",null,[n("div",pt,[o(r,{modelValue:e.search,"onUpdate:modelValue":t[31]||(t[31]=l=>e.search=l),onKeyup:t[32]||(t[32]=l=>Y(l.target.value)),type:"text",placeholder:"Search..."},null,8,["modelValue"])]),n("div",ct,[(s(!0),u(D,null,C(e.labtest,(l,a)=>(s(),u("div",{key:a,class:"border-2 flex mx-1 items-center p-1.5 rounded-md"},[n("span",bt,m(l),1),o(c,{color:"danger",icon:L(Le),title:"remove",small:"",onClick:v=>j(a)},null,8,["icon","onClick"])]))),128))]),ft,f.value.dataLab?(s(),N(p,{key:0},{default:i(()=>[(s(!0),u(D,null,C(f.value.dataLab,(l,a)=>(s(),u("div",{key:a},[n("div",_t,[n("h3",gt,m(l.title),1),o(c,{color:"info",icon:L(ee),title:"Add Medicine",small:"",onClick:y(v=>be(l.id,l.title,l.amount,l.discount,l.offered),["prevent"])},null,8,["icon","onClick"])]),yt]))),128))]),_:1})):h("",!0),o(V,{type:"justify-center lg:justify-center pt-5"},{default:i(()=>[o(c,{type:"button",color:"themeColor",small:"",label:"Submit",onClick:t[33]||(t[33]=y(l=>e.investigationModal=!1,["prevent"]))})]),_:1})])]),_:1},8,["modelValue"])],64)}}};export{Ct as default};
